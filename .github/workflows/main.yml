name: 构建插件内容

on:
  push:
    branches:
      - master

jobs:
  build-project:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - uses: pnpm/action-setup@v2
        with:
          version: 7.17.1

      - name: 设置 Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '16'
          cache: 'pnpm'
      - name: Build
          run: pnpm install && pnpm docs:build

            # 部署到 GitHub Pages
      - name: Deploy
        uses: JamesIves/github-pages-deploy-action@releases/v3
        with:
           ACCESS_TOKEN: ${{ secrets.ACCESS_TOKEN }} # 也就是我们刚才生成的 secret
           BRANCH: gh-pages # 部署到 gh-pages 分支，因为 main 分支存放的一般是源码，而 gh-pages 分支则用来存放生成的静态文件
           FOLDER: docs/.vuepress/dist # vuepress 生成的静态文件存放的地方

#
#      - name: '安装依赖'
#        run: pnpm install --frozen-lockfile
#
#
#      - name: Deploy
#        uses: JamesIves/github-pages-deploy-action@releases/v3
#        with:
#          GITHUB_TOKEN: ${{ secrets.ACCESS_TOKEN }}
#          BRANCH: master # The branch the action should deploy to.
#          FOLDER: docs/.vuepress/dist # The folder the action should deploy.
#          BUILD_SCRIPT: pnpm install && pnpm docs:build && cd docs/.vuepress/dist && echo 'dbdgs.cn' > CNAME && cd -